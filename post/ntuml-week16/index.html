<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Offliner&#39;s Blog - NTU Machine Learning Week 16 - Reinforcement Learning </title>
    
    
    <meta content="Machine Learning, Deep Learning, NTU ML 2021, NTU 機器學習 note" name="keywords">
    
    <meta content="Offliner&#39;s Blog - NTU Machine Learning 2021 Spring Week 16 - Reinforcement Learning" name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
        <link rel="icon" href="/images/dino.png">
    

    

    
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-WFQ2VM3C00"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());
          gtag('config', 'G-WFQ2VM3C00');
        </script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>
    

    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/self/css/default.css">
    <script src=" /layui/layui.js"></script>

    <link rel="stylesheet" async href="/self/css/markdown.min.css">
    <link rel="stylesheet" async href="/self/css/gallery.css">
    
    
    

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" integrity="sha256-h2tMEmhemR2IN4wbbdNjj9LaDIjzwk2hralQwfJmBOE=" crossorigin="anonymous"></script></head>

<body>
    
    <header class="layui-header layui-bg-cyan">

    
        <a href=""><img src="/images/Offliner.png" class="layui-nav-img" style="margin-left:10px;margin-top:-10px"></a>
    
    
    <a class="nav-self-logo" href="/">
        Offliner&#39;s Blog
    </a>

    <ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter="">
        
        
        <li class="layui-nav-item" id="nav_big"><a href="/post/">Posts</a></li>
        

        
            
                <li class="layui-nav-item" id="nav_big"><a href="/zone/">Archives</a></li>
            
                <li class="layui-nav-item" id="nav_big"><a href="/about/">About</a></li>
            
                <li class="layui-nav-item" id="nav_big"><a href="/">Home</a></li>
            
        

        
        <li class="layui-nav-item" id="nav_small">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-app" style="font-size: 24px;"></i>
            </a>

            <dl class="layui-nav-child">
                
                <dd><a href="/post/">Posts</a></dd>
                

                
                    
                        <dd><a href="/zone/">Archives</a></dd>
                    
                        <dd><a href="/about/">About</a></dd>
                    
                        <dd><a href="/">Home</a></dd>
                    
                
            </dl>
        </li>
    </ul>
</header>

<script>
layui.use('element', function(){
  var element = layui.element;
});
</script>

        <div id="content" style="min-height:80%">
<div class="layui-container" style="margin-bottom: 10px">
    
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <br />
                <blockquote class="self-elem-quote self-elem-quote-bg-red markdown-body single-title" >
                    <h1>NTU Machine Learning Week 16 - Reinforcement Learning</h1>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-06-11</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                </blockquote>
                <div class="layui-card-body markdown-body single-content">
                    <p><img src="/2021NTUML/Week16/cover.JPG" alt="cover"></p>
<p>NTUML 2021 Spring Course Syllabus: <a href="https://speech.ee.ntu.edu.tw/~hylee/ml/2021-spring.html">Link</a></p>
<p>Youtube Video Link (Chinese): <a href="https://youtu.be/XWukX-ayIrs"><code>Video 1</code></a> <a href="https://youtu.be/US8DFaAZcp4"><code>Video 2</code></a> <a href="https://youtu.be/kk6DqWreLeU"><code>Video 3</code></a> <a href="https://youtu.be/73YyF1gmIus"><code>Video 4</code></a> <a href="https://youtu.be/75rZwxKBAf0"><code>Video 5</code></a></p>
<p>Youtube Video Link (English): <a href="https://www.youtube.com/watch?v=0oucZNfBXlI"><code>Video 1</code></a> <a href="https://youtu.be/jbN0oYLtXps"><code>Video 2</code></a> [<code>Video 3</code>] <a href="https://youtu.be/pibO_5JhQ4U"><code>Video 4</code></a> <a href="https://youtu.be/9H3ShV57lHs"><code>Video 5</code></a></p>
<h2 id="what-is-rl-">What is RL ?</h2>
<p><img src="/2021NTUML/Week16/ML.JPG" alt="ML">
機器學習最主要在做的事情就是找一個Function，Reinforcement Learning也是機器學習的一種，所以它也是在找一個Function。在RL中會有個Actor與Environment，首先Environment會給Actor一個Observation，也就是Actor的輸入，接著Actor會有輸出Action去影響Environment來產生新的Observation，互動期間Environment會給Actor一些Reward來告訴Actor這樣的Action是否是好的。所以Actor其實就是我們要找的Function，它要能讓Actor得到Reward的總和是最大的</p>
<h2 id="example-playing-video-game">Example: Playing Video Game</h2>
<p><img src="/2021NTUML/Week16/game.JPG" alt="Game">
接下來使用Space invader來舉例，遊戲玩法是開火擊退所有外星人，而玩家有護盾可以抵擋外星人的攻擊(玩家的攻擊也會破壞護盾)，擊退外星人可以獲得分數。遊戲終止有兩個情況，一個是退所有外星人，另一個情況是玩家被外星人擊毀</p>
<p><img src="/2021NTUML/Week16/game-1.JPG" alt="Game 1">
當要訓練RL來玩這遊戲的話，Actor就是玩家，Environment是遊戲本身，Observation是遊戲畫面，Action是輸出，有三種可能的行為分別為向左向右還有開火。如果Action選擇向右的話，reward是0因為沒有擊退外星人</p>
<p><img src="/2021NTUML/Week16/game-2.JPG" alt="Game 2">
當遊戲畫面變化時，表示有新的Observation，這時就會有新的Action，如果選擇開火並擊退外星人的話，就會得到reward等於5。因此學習的目標是，讓Actor能得到的reward總和是最大的</p>
<h2 id="example-learning-to-play-go">Example: Learning to play Go</h2>
<p><img src="/2021NTUML/Week16/go.JPG" alt="Alpha Go">
若是Alpha Go的話，Environment是人類對手，Observation就是棋盤，Action就是落子的位置，透過對手的落子來產生新的Observation，然後持續下去</p>
<p><img src="/2021NTUML/Week16/go-1.JPG" alt="Alpha Go 1">
在下圍棋中，任何行為都沒辦法得到reward，因此會定義贏了才能得到reward為1，輸了得到-1分</p>
<h2 id="how-to-train-rl-">How to train RL ?</h2>
<p><img src="/2021NTUML/Week16/train.JPG" alt="train">
那要怎麼訓練RL呢?與先前的相同，第一步是有未知數的Functin，這些未知數是要被找出來的，第二步是定義loss function，第三步是最小化loss</p>
<p><img src="/2021NTUML/Week16/step1.JPG" alt="Step 1">
首先是第一步，會使用Network，輸入是遊戲畫面，輸出是每個行為的分數，這件事情其實就是分類。Network架構可以自行設計，若輸入是遊戲畫面可能會使用CNN，若想看遊戲開始到現在發生的情況就有可能使用RNN或者Transformer。最後機器會採取什麼Action取決於輸出的分數，通常會轉換成機率並隨機Sample，那為什麼不直接選擇機率最高的呢?多數RL的應用中，會選擇隨機Sample，這樣子即使看到相同畫面也有可能採取不同行為，來增加隨機性</p>
<p><img src="/2021NTUML/Week16/step2.JPG" alt="Step 2">
第二步要定義Loss，在Environment與Actor的互動中會得到許多reward直到遊戲結束，從遊戲開始到結束叫一個<code>Episode</code>，將這些reward總合起來叫Total reward或者Return，這是我們要去最大的目標，加上負號就是loss，也就是要最小化</p>
<p><img src="/2021NTUML/Week16/step3.JPG" alt="Step 3">
最後是第三步，Environment會產生Observation叫s1，再來將s1輸入給Actor產生Action叫a1，持續下去到遊戲終止，這些s與a形成的Sequence叫做<code>Trajectory</code>。得到的Reward能當成是一個Function，有些遊戲只看Action就能決定，但通常會看當下的Observation，像Space invader需要觀察Observation是否擊退敵人才能判斷是否得到reward。但這不是一般的Optimization問題，首先是Actor的輸出是有隨機性，而且Environment是個黑盒子，只知道輸入後會產生回應，但對應關係我們不知道。因此在RL中解決Optimization問題使用的方法會與之前不同</p>
<h2 id="policy-gradient">Policy Gradient</h2>
<p><img src="/2021NTUML/Week16/control.JPG" alt="Control">
首先思考要Actor在輸入Observation後如何輸出Action，先前提到這是個分類問題，當輸入某個Observation時希望能輸出向左，那麼則透過Cross-entropy來最小化loss就好，若希望不要向左則加負號即可，因此只要有適當的Label與loss，就可以控制Actor做我們想做的行為</p>
<p><img src="/2021NTUML/Week16/control-1.JPG" alt="Control 1">
因此要Actor看到s時向左，看到s&rsquo;時不要向左的話，只要定義loss是兩個case的Cross-entropy相減，再去最小化即可</p>
<p><img src="/2021NTUML/Week16/control-2.JPG" alt="Control 2">
只要收集好Actor輸入s的對應Action，就可以定義好loss去最小化</p>
<p><img src="/2021NTUML/Week16/control-3.JPG" alt="Control 3">
甚至可以給定行為一個分數，來代表我們期望Actor在特定Observation時輸出特定Action的程度。解決好loss，但問題是label和期望行為的A值怎麼來的呢?</p>
<p><img src="/2021NTUML/Week16/v0.JPG" alt="Version 0">
首先介紹最簡單的版本，但其實不正確。這個方法是Actor與Environment互動時，將產生的Action都記錄下來，這些資料通常是蒐集多個episode產生的，記錄好後會去評價這些Action是好還是不好，那要如何評價呢?可以透過每個Action得到的reward來當評價的依據，如果reward是正的表示這是個好的Action；反之，負的就不是好的Action。但這不是個好方法來訓練Actor，因為會使Actor短視近利</p>
<p><img src="/2021NTUML/Week16/v01.JPG" alt="Version 0-1">
由於Action 1會影響之後的行為，每個行為並不是獨立的，所以這方法只會選擇當下好的，不會考慮之後，因此需要<code>Reward Delay</code>來犧牲短期利益來獲取更長遠的reward。例如在Space invader中，使用最簡單的方法來評量Action的話，Actor就只會射擊，因為只有射擊會獲得Reward，左右移動並不會有，但不代表左右移動不重要，有時左右移動可以瞄準來獲得更多的Reward</p>
<p><img src="/2021NTUML/Week16/v1.JPG" alt="Version 1">
這時就有改良的版本，評量Action的標準是這個Action之後所獲得的Reward總和。但仔細想想這版本也會有些問題，若遊戲進行很長，最後所獲得的reward是因為一開始的Action嗎?有可能是之間的Action所造成的</p>
<p><img src="/2021NTUML/Week16/v2.JPG" alt="Version 2">
所以又有改良版本，乘上一個Discount Factor，所以離當下Action較近的reward有較大的權重，太遠影響較小的獲得到比較小的權重</p>
<p><img src="/2021NTUML/Week16/v3.JPG" alt="Version 3">
更進階的改良版本，將評價的分數做進一步的區分好壞，因為好壞是相對的，若大家的評價分數都是正的就難以區分，簡單的區分是設定一個baseline，高於這個標準就是正的，反之是負的，那baseline要怎麼定義呢?接下來版本會提到</p>
<p><img src="/2021NTUML/Week16/policy.JPG" alt="Policy Gradient">
實際執行蒐集資料並評價Action的步驟如上圖，最後就是計算loss來更新參數，但有個神奇的地方是蒐集資料在迴圈中，一般蒐集資料是在迴圈外但RL居然是在迴圈內</p>
<p><img src="/2021NTUML/Week16/policy-1.JPG" alt="Policy Gradient 1">
因此當蒐集完資料後就會去更新參數，但只會更新一次，更新完就要再蒐集新的資料，這就是為什麼訓練RL很花時間，假設要更新400次參數，那資料也要蒐集400次。那為什麼更新完參數要重新蒐集資料呢?</p>
<p><img src="/2021NTUML/Week16/policy-2.JPG" alt="Policy Gradient 2">
因為更新完參數後Actor變強了可能就不適用在舊資料，因此要用變強的Actor來蒐集資料再更新參數</p>
<p>若想了解更多Policy Gradient可以觀看此影片 :</p>
<ul>
<li>Deep Reinforcement Learning : <a href="https://youtu.be/W8XF3ME8G2I">Video</a></li>
</ul>
<p><img src="/2021NTUML/Week16/on-off.JPG" alt="On-policy v.s. Off-policy">
當訓練的Actor和與Environment互動的Actor是相同的話就是<code>On-policy</code>，像前面提到的Actor就是。若訓練的Actor跟與Environment互動的Actor是不同的話就是<code>Off-policy</code>，這樣的Actor訓練可以使用先前跟新的參數，所以可以不用一直蒐集資料。最有名的Off-policy方法是PPO(Proximal Policy Optimization)，有興趣的人可以參考以下影片 :</p>
<ul>
<li>Proximal Policy Optimization (PPO) : <a href="https://youtu.be/OAKAZhFmYoI">Video</a></li>
</ul>
<p><img src="/2021NTUML/Week16/exp.JPG" alt="Exploration">
RL在蒐集資料有個重要的技術是<code>Exploration</code>，也就是在Actor中加入隨機性，讓Actor在與Environment互動時能有多個情況，讓Actor學習在各種情況採取各種Action的好壞。因此有些人會刻意加大Entropy或者在參數中加入雜訊，以此提高Actor採取機率較低的Action</p>
<h2 id="actor-critic">Actor-Critic</h2>
<p><img src="/2021NTUML/Week16/critic.JPG" alt="Critic">
<code>Critic</code>是用來評估Actor的好壞，有些透過觀察Observation，有些則還會多觀察Action。有Critic後接下來是<code>Value Function</code>，輸入是Observation，輸出是一個數值，這個數值是Value Function看到這個Observation後預測接下來獲得的Discounted Cumulated Reward是多少</p>
<p><img src="/2021NTUML/Week16/critic-1.JPG" alt="Critic 1">
接下來介紹怎麼訓練Critic，有兩種常用的方法，第一種是<code>Monte-Carlo (MC) based approach</code>，直接拿Actor與環境互動很多輪，接下來輸入互動時看到的Observation得到預估的分數，和實際得到的分越接近越好</p>
<p><img src="/2021NTUML/Week16/critic-2.JPG" alt="Critic 2">
另一種做法是<code>Temporal-difference (TD) approach</code>，不需要玩完整場遊戲，只需要看當下的Observation、Action、Reward與下一個Observation就可以來訓練，適合用於長度較長的遊戲或者沒有結局的遊戲。透過上面的式子，可以發現雖然我們不知道當下的Observation實際得到多少分，但可以知道當下Observation與下一個Observation之間的差值</p>
<p><img src="/2021NTUML/Week16/vs.JPG" alt="vs">
假設有一個簡單的遊戲，第一回合是看到Sa得到reward為0，接下來看到Sb得到reward為1就結束，接下來數回合只看到Sb得到reward後就結束。透過Value Function來計算Sb期望獲得的分數，8場有6場得到1，2場得到0，因此為3/4，那Sa為多少呢?有可能是0或者3/4，0的話是MC的想法，3/4是TD的想法，兩者皆是對的，只是背後的假設不同</p>
<p><img src="/2021NTUML/Week16/v35.JPG" alt="Version 3.5">
將先前提到的Version 3改良後，將Baseline變成當下Observation透過Value Function得到的分數，那為什麼可以這麼做呢?</p>
<p><img src="/2021NTUML/Week16/v35-1.JPG" alt="Version 3.5-1">
輸入當下的Observation，因為在Actor會隨機Sample出Action來增加隨機性，因此同樣的Observation會有多種可能Action，將這些可能透過Value Function來計算出數值。而當執行某一個Action得到的值大於Value Function來計算出數值，表示這個Action比Sample多次Action的平均還要好；反之，還要差。但可能會覺得疑惑的點是，這個Action也是Sample出來的，拿一個隨機的Action去減掉平均會比較好嗎?</p>
<p><img src="/2021NTUML/Week16/v4.JPG" alt="Version 4">
所以就有了改良版本，拿平均減去平均，將執行Action後的Observation輸入Value Function來計算平均，這樣子就可以知道採取這個Action的期望Reward與隨機Sample的期望Reward哪個比較好，這就是有名的<code>Advantage Actor-Critic</code></p>
<p><img src="/2021NTUML/Week16/tip.JPG" alt="Tip">
訓練Actor-Critic有個小技巧，在實作時，由於Actor與Critic都是個Network，因為輸入都是Observation輸出不同而已，所以可以共用Network，如果輸出不同的Action就是Actor，輸出數值就是Critic</p>
<p><img src="/2021NTUML/Week16/dqn.JPG" alt="DQN">
在Reinforcement Learning中還有個做法，直接採取Critic來決定Action，最知名的就是<code>Deep Q Network (DQN)</code>，若想了解DQN可以觀看以下影片與論文 :</p>
<ul>
<li>Q-learning (Basic Idea) : <a href="https://youtu.be/o_g9JUMw1Oc">Video</a></li>
<li>Q-learning (Advanced Tips) : <a href="https://youtu.be/2-zGCx4iv_k">Video</a></li>
<li>Rainbow: Combining Improvements in Deep Reinforcement Learning : <a href="https://arxiv.org/abs/1710.02298">Link</a></li>
</ul>
<h2 id="reward-shaping">Reward Shaping</h2>
<p><img src="/2021NTUML/Week16/sparse.JPG" alt="Sparse Reward">
到目前為止是拿Actor與Environment互動，再把得到的Reward做一些處理來訓練Actor，但如果Reward幾乎都是0要怎麼辦?Reward幾乎都是0表示不管執行什麼Action都沒差，這樣會難以訓練Actor，因此需要想辦法提供額外的Reward來幫助Agent學習，這就是<code>Reward Shaping</code>。下面影片示範一款遊戲叫VizDoom。這款遊戲中殺敵人可以加分，被殺掉會扣分，單使用遊戲中的reward來訓練Agent會很難訓練起來</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/94EPSjQH38Y" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p><img src="/2021NTUML/Week16/vizdoom.JPG" alt="VizDoom">
這遊戲中第一名的隊伍定義的Reward Shaping如上表所示，像第二點被扣血的話扣0.05分，如果沒有Reward Shaping的話需要等機器被殺死後才有可能學到這是不好的事情，有許多事情是在遊戲中不會得到分數，需要人類強加讓機器來學習。還有些比較有趣的reward，像第七點和第八點，如果一直待在原地就扣0.03分，動一下給很小的分數，因為一開始機器不強，出去有高機率就被敵人打死，所以沒有這樣的機制可能會讓機器一直待在原地。又為了怕機器可能轉圈或者一直躲敵人，所以有第一點活著就扣0.008分，強迫機器出去與敵人對戰。看到這些Reward Shaping，可以得知這需要對Environment有一定程度的了解</p>
<h2 id="no-reward-learning-from-demonstration">No Reward: Learning from Demonstration</h2>
<p><img src="/2021NTUML/Week16/noreward.JPG" alt="No reward">
對於像遊戲之類的事情，很容易定義出Reward，但如果reward都沒有呢?或許可以使用Reward Shaping，但有時機器會學出令人意想不到的事，有個方法可以解決叫<code>Imitation Learning</code>，在這方法中Actor仍然會與Environment互動，但不會得到任何reward，不過會有Expert與環境互動，Expert通常是人類，將互動記錄下來給Actor學習</p>
<p><img src="/2021NTUML/Week16/supervised.JPG" alt="Supervised Learning">
或許有人會覺得這不就是<code>Supervised Learning</code>嗎?沒錯，因為機器只會去模仿Expert的行為叫做<code>Behavior Cloning</code>，但如果機器只會複製Expert行為會有些問題，例如自駕車，當Expert都順利過彎時，機器也學會過彎，但這樣機器在遇到要撞牆的情況時就會不知道怎麼辦，因為Expert沒有示範過</p>
<p><img src="/2021NTUML/Week16/inverse.JPG" alt="Inverse Reinforcement Learning">
因此就有更進階的方法叫<code>Inverse Reinforcement Learning</code>，透過Expert示範的紀錄與Environment，去學習說Reward該怎麼定義，當有Reward Function就可以用之前介紹的Reinforcement Learning來訓練</p>
<p><img src="/2021NTUML/Week16/inverse-1.JPG" alt="Inverse Reinforcement Learning 1">
在這方法的基本原則是Expert的行為會被定義為獲得最高的Reward，Actor會與Environment互動來獲得紀錄，接著定義一個Reward Function，這Function會將Expert的行為評的比較高分，Actor會比較低分，再來Actor就會去更新參數去最大化Reward Function，最終學到的Reward Function就是我們要的</p>
<p><img src="/2021NTUML/Week16/IRL.JPG" alt="Inverse Reinforcement Learning 2">
上圖為Inverse Reinforcement Learning的流程，整個框架就像是GAN</p>
<p><img src="/2021NTUML/Week16/GAN.JPG" alt="Inverse Reinforcement Learning vs GAN">
兩者有異曲同工之妙，只是不同的名字而已。將Inverse Reinforcement Learning套用在機器手臂上如下影片示範</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/hXxaepw0zAw" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p><img src="/2021NTUML/Week16/RIG.JPG" alt="Reinforcement learning with Imagined Goals">
想要訓練機器手臂，除了人類示範以外，甚至還能給機器圖片，要它達到圖片的結果，若想了解更多可以參考以下連結 :</p>
<ul>
<li>Visual Reinforcement Learning with Imagined Goals : <a href="https://arxiv.org/abs/1807.04742">Link</a></li>
<li>Skew-Fit: State-Covering Self-Supervised Reinforcement Learning : <a href="https://arxiv.org/abs/1903.03698">Link</a></li>
</ul>
</div>
            </div>
            
                <script src="https://utteranc.es/client.js"
                    repo="Offliners/MyBlogComments"
                    issue-term="pathname"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>
                </script>
            
        </div>

        <div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
            
            <div class="layui-card single-card">
                <h2 class="single-title">- Table of Contents -</h2>
                <div style="margin-left: 10px;">   
                    <div>

<ul class="toc-h2"><li><a href="/post/ntuml-week16/#what-is-rl-">What is RL ?</a></li>
            <li><a href="/post/ntuml-week16/#example-playing-video-game">Example: Playing Video Game</a></li>
            <li><a href="/post/ntuml-week16/#example-learning-to-play-go">Example: Learning to play Go</a></li>
            <li><a href="/post/ntuml-week16/#how-to-train-rl-">How to train RL ?</a></li>
            <li><a href="/post/ntuml-week16/#policy-gradient">Policy Gradient</a></li>
            <li><a href="/post/ntuml-week16/#actor-critic">Actor-Critic</a></li>
            <li><a href="/post/ntuml-week16/#reward-shaping">Reward Shaping</a></li>
            <li><a href="/post/ntuml-week16/#no-reward-learning-from-demonstration">No Reward: Learning from Demonstration</a></li>
            </div>
                </div>
            </div>
            

            
            <div class="layui-card single-card">
                <h2 class="single-title">- Relevant Topics -</h2>
                
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/ntuml-week14/">
                                <h3 class="">NTU Machine Learning Week 14 - Domain Adaptation</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-24</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/ntuml-week13/">
                                <h3 class="">NTU Machine Learning Week 13 - Explainable AI</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-16</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/ntuml-week11/">
                                <h3 class="">NTU Machine Learning Week 11 - Adversarial Attack</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-15</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/ntuml-week10/">
                                <h3 class="">NTU Machine Learning Week 10 - Auto-Encoder</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-01</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/ntuml-week8/">
                                <h3 class="">NTU Machine Learning Week 8 - BERT</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-04-21</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                
                <br />
            </div>
            

            <div class="layui-card single-card">
                <h2 class="single-title">- Recent Posts -</h2>
            
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week16/">
                        <h3 class="">NTU Machine Learning Week 16 - Reinforcement Learning</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-06-11</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week14/">
                        <h3 class="">NTU Machine Learning Week 14 - Domain Adaptation</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-24</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week13/">
                        <h3 class="">NTU Machine Learning Week 13 - Explainable AI</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-16</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week11/">
                        <h3 class="">NTU Machine Learning Week 11 - Adversarial Attack</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-15</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week10/">
                        <h3 class="">NTU Machine Learning Week 10 - Auto-Encoder</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-01</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
            
            <br />
            </div>
        </div>
    </div>
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WFQ2VM3C00"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WFQ2VM3C00');
</script>
    
</div>

        </div><footer>
    

    <div class="layui-container">
        <div class="layui-row">
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs6">
            </div>
        </div>
        <div class="layui-row">
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href="/zone/"><p class="footer-url">Archives</p></a>
            </div>
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href="/about/"><p class="footer-url">About</p></a>
            </div>
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href="/"><p class="footer-url">Home</p></a>
            </div>
            
        </div>
    </div>
    
    
    <div class="layui-container">
        <p class="copyright">&copy; All rights reserved. Powered by <a href='https://gohugo.io' style='color:#FFFFFF'>Hugo</a> and <a href='https://github.com/ertuil/erblog' style='color:#FFFFFF'>Erblog</a>.</p>
    </div>
</footer>

</body>
</html>
