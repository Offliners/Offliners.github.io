<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Offliner&#39;s Blog - ORBSLAM2 程式碼解析 - MapPoint </title>
    
    
    <meta content="ORBSLAM2, code analysis, ORBSLAM2 程式碼解析" name="keywords">
    
    <meta content="Offliner&#39;s Blog - System Overview Source Code : Link MapPoint是地圖中的特徵點，自身參數是3D座標與描述子，在此類別中會完成以下工作 :
 維護關鍵幀之間的共視關係 通過計算描述向量之間的距離，在多個關鍵幀的特徵點中找到最匹配的特徵點 在閉環完成修正後，需要根據修正的主幀位姿來修正特徵點 對於非關鍵幀，也能產生MapPoint，只是是用來給Tracking功能臨時使用  以下為MapPoint中的主要函數
MapPoint │ ├── MapPoint // 建構函數 ├──────── 關鍵幀地圖點建構函數 ├──────── 普通幀地圖點建構函數 │ ├── AddObservation // 增加地圖點觀測關係 │ ├── EraseObservation // 刪除地圖點觀測關係 │ ├── SetBadFlag // 刪除地圖點 │ ├── Replace // 替換地圖點 │ ├── ComputeDistinctiveDescriptors // 計算描述子 │ ├── UpdateNormalAndDepth // 更新法向量和深度值 │ ├── PredictScale // 預測尺度 建構函數 MapPoint 一共有兩個，分別對應關鍵幀與普通幀
關鍵幀的地圖點建構函數 MapPoint(const cv::Mat &amp;Pos, KeyFrame *pRefKF, Map* pMap) Pos為該點的3D位置，pRefKF是參考關鍵幀，pMap是地圖。關鍵幀的地圖點建構函數主要是突出地圖點與關鍵幀之間的關係，一個地圖點會被多個關鍵幀偵測到，多個關鍵幀之間透過共同偵測到的地圖點來產生關係，叫做共視關係。在ORBSLAM中，是透過MapPoint來維護共視關係。在進行BA優化時，指優化具有共視關係的關鍵幀，其他關鍵幀的位姿則不參與優化" name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
        <link rel="icon" href="/images/dino.png">
    

    

    
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-WFQ2VM3C00"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());
          gtag('config', 'G-WFQ2VM3C00');
        </script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>
    

    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/self/css/default.css">
    <script src=" /layui/layui.js"></script>

    <link rel="stylesheet" async href="/self/css/markdown.min.css">
    <link rel="stylesheet" async href="/self/css/gallery.css">
    
    
    

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" integrity="sha256-h2tMEmhemR2IN4wbbdNjj9LaDIjzwk2hralQwfJmBOE=" crossorigin="anonymous"></script></head>

<body>
    
    <header class="layui-header layui-bg-cyan">

    
        <a href=""><img src="/images/Offliner.png" class="layui-nav-img" style="margin-left:10px;margin-top:-10px"></a>
    
    
    <a class="nav-self-logo" href="/">
        Offliner&#39;s Blog
    </a>

    <ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter="">
        
        
        <li class="layui-nav-item" id="nav_big"><a href="/post/">Posts</a></li>
        

        
            
                <li class="layui-nav-item" id="nav_big"><a href="/zone/">Archives</a></li>
            
                <li class="layui-nav-item" id="nav_big"><a href="/about/">About</a></li>
            
                <li class="layui-nav-item" id="nav_big"><a href="/">Home</a></li>
            
        

        
        <li class="layui-nav-item" id="nav_small">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-app" style="font-size: 24px;"></i>
            </a>

            <dl class="layui-nav-child">
                
                <dd><a href="/post/">Posts</a></dd>
                

                
                    
                        <dd><a href="/zone/">Archives</a></dd>
                    
                        <dd><a href="/about/">About</a></dd>
                    
                        <dd><a href="/">Home</a></dd>
                    
                
            </dl>
        </li>
    </ul>
</header>

<script>
layui.use('element', function(){
  var element = layui.element;
});
</script>

        <div id="content" style="min-height:80%">
<div class="layui-container" style="margin-bottom: 10px">
    
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <br />
                <blockquote class="self-elem-quote self-elem-quote-bg-red markdown-body single-title" >
                    <h1>ORBSLAM2 程式碼解析 - MapPoint</h1>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-04-28</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/orbslam2-%e7%a8%8b%e5%bc%8f%e7%a2%bc%e8%a7%a3%e6%9e%90/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2 程式碼解析</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/orbslam2/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2</span>
        </a>
    
        <a href="/tags/code-analysis/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">code analysis</span>
        </a>
    
    
</h3>

                </blockquote>
                <div class="layui-card-body markdown-body single-content">
                    <h2 id="system-overview">System Overview</h2>
<p><img src="/ORBSLAM2-img/system-overview.JPG" alt="System Overview"></p>
<h4 id="source-code--linkhttpsgithubcomraulmurorb_slam2">Source Code : <a href="https://github.com/raulmur/ORB_SLAM2">Link</a></h4>
<p>MapPoint是地圖中的特徵點，自身參數是3D座標與描述子，在此類別中會完成以下工作 :</p>
<ul>
<li>維護關鍵幀之間的共視關係</li>
<li>通過計算描述向量之間的距離，在多個關鍵幀的特徵點中找到最匹配的特徵點</li>
<li>在閉環完成修正後，需要根據修正的主幀位姿來修正特徵點</li>
<li>對於非關鍵幀，也能產生MapPoint，只是是用來給Tracking功能臨時使用</li>
</ul>
<p>以下為MapPoint中的主要函數</p>
<pre><code>MapPoint
│
├── MapPoint  // 建構函數
├──────── 關鍵幀地圖點建構函數
├──────── 普通幀地圖點建構函數
│
├── AddObservation  // 增加地圖點觀測關係
│
├── EraseObservation  // 刪除地圖點觀測關係
│
├── SetBadFlag  // 刪除地圖點
│
├── Replace  // 替換地圖點
│
├── ComputeDistinctiveDescriptors  // 計算描述子
│
├── UpdateNormalAndDepth  // 更新法向量和深度值
│
├── PredictScale  // 預測尺度
</code></pre><h2 id="建構函數-mappoint">建構函數 MapPoint</h2>
<p>一共有兩個，分別對應關鍵幀與普通幀</p>
<h4 id="關鍵幀的地圖點建構函數">關鍵幀的地圖點建構函數</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">MapPoint(<span style="color:#66d9ef">const</span> cv<span style="color:#f92672">::</span>Mat <span style="color:#f92672">&amp;</span>Pos, KeyFrame <span style="color:#f92672">*</span>pRefKF, Map<span style="color:#f92672">*</span> pMap)
</code></pre></div><p>Pos為該點的3D位置，pRefKF是參考關鍵幀，pMap是地圖。關鍵幀的地圖點建構函數主要是突出地圖點與關鍵幀之間的關係，一個地圖點會被多個關鍵幀偵測到，多個關鍵幀之間透過共同偵測到的地圖點來產生關係，叫做共視關係。在ORBSLAM中，是透過MapPoint來維護共視關係。在進行BA優化時，指優化具有共視關係的關鍵幀，其他關鍵幀的位姿則不參與優化</p>
<h4 id="普通幀的地圖點建構函數">普通幀的地圖點建構函數</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">MapPoint(<span style="color:#66d9ef">const</span> cv<span style="color:#f92672">::</span>Mat <span style="color:#f92672">&amp;</span>Pos, Map<span style="color:#f92672">*</span> pMap, Frame<span style="color:#f92672">*</span> pFrame, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>idxF)
</code></pre></div><p>Pos為該點的3D位置，pMap是地圖，pFrame是對應的普通幀，idxF是地圖點在該幀特徵點的索引值</p>
<h2 id="增加地圖點的觀測關係">增加地圖點的觀測關係</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> MapPoint<span style="color:#f92672">::</span>AddObservation(KeyFrame<span style="color:#f92672">*</span> pKF, size_t idx)
{
    unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock(mMutexFeatures);
    
    <span style="color:#75715e">// 判斷是否已經存在觀測關係
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span>(mObservations.count(pKF))
        <span style="color:#66d9ef">return</span>;  <span style="color:#75715e">// 已存在則返回
</span><span style="color:#75715e"></span>    mObservations[pKF]<span style="color:#f92672">=</span>idx;  <span style="color:#75715e">// 不存在則添加
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">// 分成一元與二元兩種來添加觀測數目
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span>(pKF<span style="color:#f92672">-&gt;</span>mvuRight[idx]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>)
        nObs<span style="color:#f92672">+=</span><span style="color:#ae81ff">2</span>;  <span style="color:#75715e">// 二元觀測數目加2
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">else</span>
        nObs<span style="color:#f92672">++</span>;  <span style="color:#75715e">// 一元觀測數目加1
</span><span style="color:#75715e"></span>}
</code></pre></div><p>這裡有兩個重要的變數 :</p>
<h4 id="stdmapkeyframesize_t-mobservations">std::map&lt;KeyFrame*,size_t&gt; mObservations</h4>
<p>此變數用來存放觀測關係，它儲存觀測到該MapPoint的關鍵幀與MapPoint在該關鍵幀中對應的索引值</p>
<h4 id="int-nobs">int nObs</h4>
<p>此變數用來記錄被觀測到的次數</p>
<h2 id="刪除觀測關係">刪除觀測關係</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> MapPoint<span style="color:#f92672">::</span>EraseObservation(KeyFrame<span style="color:#f92672">*</span> pKF)
{
    <span style="color:#66d9ef">bool</span> bBad<span style="color:#f92672">=</span>false;
    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock(mMutexFeatures);
        
        <span style="color:#75715e">// 判斷該關鍵幀是否存在觀測關係，即該關鍵幀是否看到這個MapPoint
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(mObservations.count(pKF))
        {
            <span style="color:#66d9ef">int</span> idx <span style="color:#f92672">=</span> mObservations[pKF];
            
            <span style="color:#75715e">// 分成一元與二元兩種來減少觀測數目
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(pKF<span style="color:#f92672">-&gt;</span>mvuRight[idx]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>)
                nObs<span style="color:#f92672">-=</span><span style="color:#ae81ff">2</span>;  <span style="color:#75715e">// 二元觀測數目減2
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">else</span>
                nObs<span style="color:#f92672">--</span>;  <span style="color:#75715e">// 一元觀測數目減1
</span><span style="color:#75715e"></span>
            mObservations.erase(pKF);  <span style="color:#75715e">// 刪除該關鍵幀對應的觀測關係
</span><span style="color:#75715e"></span>
            <span style="color:#75715e">// 如果該關鍵幀是參考關鍵幀的話，則重新指定
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(mpRefKF<span style="color:#f92672">==</span>pKF)
                mpRefKF<span style="color:#f92672">=</span>mObservations.begin()<span style="color:#f92672">-&gt;</span>first;

            <span style="color:#75715e">// 當被觀測次數小於等於2時，該地圖需要被剔除
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(nObs<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">2</span>)
                bBad<span style="color:#f92672">=</span>true;
        }
    }

    <span style="color:#66d9ef">if</span>(bBad)
        SetBadFlag();  <span style="color:#75715e">// 剔除地圖
</span><span style="color:#75715e"></span>}
</code></pre></div><p>參數pKF為關鍵幀。此函數先判斷該關鍵幀是否在觀測中，如果在則從存放觀測關係的mObservations中移除，接著判斷是否為參考關鍵幀，如果是則將參考關鍵幀換成觀測的第一幀，因為不能沒有參考關鍵幀。刪除關鍵幀後，若該MapPoint被觀測數目小於等於2時，則該MapPoint就沒有存在的必要，需要剔除</p>
<h2 id="刪除地圖點">刪除地圖點</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> MapPoint<span style="color:#f92672">::</span>SetBadFlag()
{
    map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;</span> obs;
    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock1(mMutexFeatures);
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock2(mMutexPos);
        mbBad<span style="color:#f92672">=</span>true;
        obs <span style="color:#f92672">=</span> mObservations;
        mObservations.clear();  <span style="color:#75715e">// 清除該地圖點所有的觀測關係
</span><span style="color:#75715e"></span>    }
    <span style="color:#66d9ef">for</span>(map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;::</span>iterator mit<span style="color:#f92672">=</span>obs.begin(), mend<span style="color:#f92672">=</span>obs.end(); mit<span style="color:#f92672">!=</span>mend; mit<span style="color:#f92672">++</span>)
    {
        KeyFrame<span style="color:#f92672">*</span> pKF <span style="color:#f92672">=</span> mit<span style="color:#f92672">-&gt;</span>first;
        pKF<span style="color:#f92672">-&gt;</span>EraseMapPointMatch(mit<span style="color:#f92672">-&gt;</span>second);  <span style="color:#75715e">// 刪除關鍵幀中和該MapPoint對應的匹配關係
</span><span style="color:#75715e"></span>    }

    mpMap<span style="color:#f92672">-&gt;</span>EraseMapPoint(<span style="color:#66d9ef">this</span>);  <span style="color:#75715e">// 從地圖中刪除MapPoint
</span><span style="color:#75715e"></span>}
</code></pre></div><p>此函數主要用來刪除地圖點，並清除關鍵幀與地圖中所有與該地圖點對應的關聯關係</p>
<h2 id="替換地圖點">替換地圖點</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> MapPoint<span style="color:#f92672">::</span>Replace(MapPoint<span style="color:#f92672">*</span> pMP)
{
    <span style="color:#75715e">// 如果傳入的MapPoint就是該MapPoint則直接跳出
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span>(pMP<span style="color:#f92672">-&gt;</span>mnId<span style="color:#f92672">==</span><span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>mnId)
        <span style="color:#66d9ef">return</span>;

    <span style="color:#66d9ef">int</span> nvisible, nfound;
    map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;</span> obs;
    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock1(mMutexFeatures);
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock2(mMutexPos);
        obs<span style="color:#f92672">=</span>mObservations;
        mObservations.clear();
        mbBad<span style="color:#f92672">=</span>true;
        nvisible <span style="color:#f92672">=</span> mnVisible;
        nfound <span style="color:#f92672">=</span> mnFound;
        mpReplaced <span style="color:#f92672">=</span> pMP;
    }

    <span style="color:#66d9ef">for</span>(map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;::</span>iterator mit<span style="color:#f92672">=</span>obs.begin(), mend<span style="color:#f92672">=</span>obs.end(); mit<span style="color:#f92672">!=</span>mend; mit<span style="color:#f92672">++</span>)
    {
        KeyFrame<span style="color:#f92672">*</span> pKF <span style="color:#f92672">=</span> mit<span style="color:#f92672">-&gt;</span>first;

        <span style="color:#75715e">// 如果輸入的MapPoint不在關鍵幀的觀測關係中，則添加觀測關係
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>pMP<span style="color:#f92672">-&gt;</span>IsInKeyFrame(pKF))
        {
            pKF<span style="color:#f92672">-&gt;</span>ReplaceMapPointMatch(mit<span style="color:#f92672">-&gt;</span>second, pMP);
            pMP<span style="color:#f92672">-&gt;</span>AddObservation(pKF,mit<span style="color:#f92672">-&gt;</span>second);
        }
        <span style="color:#75715e">// 如果在關鍵幀的觀測關係中，就刪除關鍵幀和舊的MapPoint之間的對應關係
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">else</span>
        {
            pKF<span style="color:#f92672">-&gt;</span>EraseMapPointMatch(mit<span style="color:#f92672">-&gt;</span>second);
        }
    }
    pMP<span style="color:#f92672">-&gt;</span>IncreaseFound(nfound);
    pMP<span style="color:#f92672">-&gt;</span>IncreaseVisible(nvisible);
    pMP<span style="color:#f92672">-&gt;</span>ComputeDistinctiveDescriptors();

    mpMap<span style="color:#f92672">-&gt;</span>EraseMapPoint(<span style="color:#66d9ef">this</span>);  <span style="color:#75715e">// 刪除Map中該地圖點
</span><span style="color:#75715e"></span>}

</code></pre></div><p>參數pMP就是用來替換的地圖點。此函數要將當前地圖點(this)替換成pMP，因為在使用閉環時，完成閉環以後需要調整地圖點與關鍵幀來建立新關係。具體流程是循遍所有觀測訊息，判斷輸入的MapPoint是否在該關鍵幀中，如果在就只要移除舊MapPoint的匹配訊息，再增加這個MapPoint找到的數量、可見次數與計算這個該點獨有的描述子即可，最後將舊MapPoint移除</p>
<h2 id="計算最匹配的描述子">計算最匹配的描述子</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> MapPoint<span style="color:#f92672">::</span>ComputeDistinctiveDescriptors()
{
    vector<span style="color:#f92672">&lt;</span>cv<span style="color:#f92672">::</span>Mat<span style="color:#f92672">&gt;</span> vDescriptors;

    map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;</span> observations;

    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock1(mMutexFeatures);
        
        <span style="color:#75715e">// 如果地圖標記為不好則直接返回
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(mbBad)
            <span style="color:#66d9ef">return</span>;
        observations<span style="color:#f92672">=</span>mObservations;
    }

    <span style="color:#75715e">// 如果觀測為空則返回
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span>(observations.empty())
        <span style="color:#66d9ef">return</span>;

    <span style="color:#75715e">// 保留的描述子數量最多與觀測數量相同
</span><span style="color:#75715e"></span>    vDescriptors.reserve(observations.size());

    <span style="color:#66d9ef">for</span>(map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;::</span>iterator mit<span style="color:#f92672">=</span>observations.begin(), mend<span style="color:#f92672">=</span>observations.end(); mit<span style="color:#f92672">!=</span>mend; mit<span style="color:#f92672">++</span>)
    {
        KeyFrame<span style="color:#f92672">*</span> pKF <span style="color:#f92672">=</span> mit<span style="color:#f92672">-&gt;</span>first;

        <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>pKF<span style="color:#f92672">-&gt;</span>isBad())
            vDescriptors.push_back(pKF<span style="color:#f92672">-&gt;</span>mDescriptors.row(mit<span style="color:#f92672">-&gt;</span>second));  <span style="color:#75715e">// 針對每幀對應的都提取其描述子
</span><span style="color:#75715e"></span>    }

    <span style="color:#66d9ef">if</span>(vDescriptors.empty())
        <span style="color:#66d9ef">return</span>;

    <span style="color:#66d9ef">const</span> size_t N <span style="color:#f92672">=</span> vDescriptors.size();

    <span style="color:#66d9ef">float</span> Distances[N][N];
    <span style="color:#66d9ef">for</span>(size_t i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>N;i<span style="color:#f92672">++</span>)
    {
        Distances[i][i]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
        <span style="color:#66d9ef">for</span>(size_t j<span style="color:#f92672">=</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;j<span style="color:#f92672">&lt;</span>N;j<span style="color:#f92672">++</span>)
        {
            <span style="color:#66d9ef">int</span> distij <span style="color:#f92672">=</span> ORBmatcher<span style="color:#f92672">::</span>DescriptorDistance(vDescriptors[i],vDescriptors[j]);
            Distances[i][j]<span style="color:#f92672">=</span>distij;
            Distances[j][i]<span style="color:#f92672">=</span>distij;
        }
    }

    <span style="color:#75715e">// 選擇其他描述子中距離最小的描述子作為地圖點的描述子，基本上類似取平均值
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> BestMedian <span style="color:#f92672">=</span> INT_MAX;
    <span style="color:#66d9ef">int</span> BestIdx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(size_t i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>N;i<span style="color:#f92672">++</span>)
    {
        vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> vDists(Distances[i],Distances[i]<span style="color:#f92672">+</span>N);
        sort(vDists.begin(),vDists.end());
        <span style="color:#66d9ef">int</span> median <span style="color:#f92672">=</span> vDists[<span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>(N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)];

        <span style="color:#66d9ef">if</span>(median<span style="color:#f92672">&lt;</span>BestMedian)
        {
            BestMedian <span style="color:#f92672">=</span> median;
            BestIdx <span style="color:#f92672">=</span> i;
        }
    }

    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock(mMutexFeatures);
        mDescriptor <span style="color:#f92672">=</span> vDescriptors[BestIdx].clone();
    }
}
</code></pre></div><p>一個MapPoint會被許多相機觀測到，因此在插入關鍵幀後，需要判斷是否更新當前點最適合的描述子。最好的描述子與其他描述子應該會有最小的平均距離，因此先取得當前點所有的描述子，然後計算描述子之間的距離再取平均，最後找離這個均值最近的描述子</p>
<h2 id="更新法向量與深度值">更新法向量與深度值</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> MapPoint<span style="color:#f92672">::</span>UpdateNormalAndDepth()
{
    map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;</span> observations;
    KeyFrame<span style="color:#f92672">*</span> pRefKF;
    cv<span style="color:#f92672">::</span>Mat Pos;
    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock1(mMutexFeatures);
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock2(mMutexPos);
        <span style="color:#66d9ef">if</span>(mbBad)
            <span style="color:#66d9ef">return</span>;
        observations<span style="color:#f92672">=</span>mObservations;
        pRefKF<span style="color:#f92672">=</span>mpRefKF;
        Pos <span style="color:#f92672">=</span> mWorldPos.clone();
    }

    <span style="color:#66d9ef">if</span>(observations.empty())
        <span style="color:#66d9ef">return</span>;

    cv<span style="color:#f92672">::</span>Mat normal <span style="color:#f92672">=</span> cv<span style="color:#f92672">::</span>Mat<span style="color:#f92672">::</span>zeros(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>,CV_32F);
    <span style="color:#66d9ef">int</span> n<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(map<span style="color:#f92672">&lt;</span>KeyFrame<span style="color:#f92672">*</span>,size_t<span style="color:#f92672">&gt;::</span>iterator mit<span style="color:#f92672">=</span>observations.begin(), mend<span style="color:#f92672">=</span>observations.end(); mit<span style="color:#f92672">!=</span>mend; mit<span style="color:#f92672">++</span>)
    {
        KeyFrame<span style="color:#f92672">*</span> pKF <span style="color:#f92672">=</span> mit<span style="color:#f92672">-&gt;</span>first;
        cv<span style="color:#f92672">::</span>Mat Owi <span style="color:#f92672">=</span> pKF<span style="color:#f92672">-&gt;</span>GetCameraCenter();
        cv<span style="color:#f92672">::</span>Mat normali <span style="color:#f92672">=</span> mWorldPos <span style="color:#f92672">-</span> Owi;  <span style="color:#75715e">// 觀測點座標減去關鍵幀中相機光心的座標就是觀測方向，也就是相機光心指向地圖點的方向
</span><span style="color:#75715e"></span>        normal <span style="color:#f92672">=</span> normal <span style="color:#f92672">+</span> normali<span style="color:#f92672">/</span>cv<span style="color:#f92672">::</span>norm(normali);  <span style="color:#75715e">// 對其進行歸一化後相加
</span><span style="color:#75715e"></span>        n<span style="color:#f92672">++</span>;
    }

    cv<span style="color:#f92672">::</span>Mat PC <span style="color:#f92672">=</span> Pos <span style="color:#f92672">-</span> pRefKF<span style="color:#f92672">-&gt;</span>GetCameraCenter();
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">float</span> dist <span style="color:#f92672">=</span> cv<span style="color:#f92672">::</span>norm(PC);
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> level <span style="color:#f92672">=</span> pRefKF<span style="color:#f92672">-&gt;</span>mvKeysUn[observations[pRefKF]].octave;
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">float</span> levelScaleFactor <span style="color:#f92672">=</span>  pRefKF<span style="color:#f92672">-&gt;</span>mvScaleFactors[level];
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> nLevels <span style="color:#f92672">=</span> pRefKF<span style="color:#f92672">-&gt;</span>mnScaleLevels;

    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock3(mMutexPos);
        mfMaxDistance <span style="color:#f92672">=</span> dist<span style="color:#f92672">*</span>levelScaleFactor;
        mfMinDistance <span style="color:#f92672">=</span> mfMaxDistance<span style="color:#f92672">/</span>pRefKF<span style="color:#f92672">-&gt;</span>mvScaleFactors[nLevels<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
        mNormalVector <span style="color:#f92672">=</span> normal<span style="color:#f92672">/</span>n;
    }
}
</code></pre></div><p>由於圖像提取描述子是使用金字塔分層提取，所以計算法向量和深度可以知道該MapPoint對應的關鍵幀可以從金字塔哪一層中提取到。而法向量就是相機光心指向地圖點的方向，計算方法就是將地圖點的三D座標減去相機光心的3D座標即可</p>
<p>而深度範圍為地圖點到參考幀(只有1幀)相機中心的距離，乘上參考幀中描述子獲得的金字塔放大尺度就可得最大距離<code>mfMaxDistance</code>。最大距離除以整個金字塔最高層的放大尺度就可以得到最小距離<code>mfMinDistance</code>。通常來說，距離較近的地圖點將在金字塔較高的地方提取出;反之，距離較遠的地圖點將在金字塔較低的地方提取出(金字塔曾數越低，分辨率愈高，因此能識別出遠近)。透過地圖點訊息(主要是對應的描述子)，可以獲得該地圖點對應的金字塔層級，進而預測該地圖在什麼範圍內能被觀測到</p>
<h2 id="預測尺度">預測尺度</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">int</span> MapPoint<span style="color:#f92672">::</span>PredictScale(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">float</span> <span style="color:#f92672">&amp;</span>currentDist, KeyFrame<span style="color:#f92672">*</span> pKF)
{
    <span style="color:#66d9ef">float</span> ratio;
    {
        unique_lock<span style="color:#f92672">&lt;</span>mutex<span style="color:#f92672">&gt;</span> lock(mMutexPos);
        ratio <span style="color:#f92672">=</span> mfMaxDistance<span style="color:#f92672">/</span>currentDist;
    }

    <span style="color:#66d9ef">int</span> nScale <span style="color:#f92672">=</span> ceil(log(ratio)<span style="color:#f92672">/</span>pKF<span style="color:#f92672">-&gt;</span>mfLogScaleFactor);
    <span style="color:#66d9ef">if</span>(nScale<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>)
        nScale <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span>(nScale<span style="color:#f92672">&gt;=</span>pKF<span style="color:#f92672">-&gt;</span>mnScaleLevels)
        nScale <span style="color:#f92672">=</span> pKF<span style="color:#f92672">-&gt;</span>mnScaleLevels<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;

    <span style="color:#66d9ef">return</span> nScale;
}
</code></pre></div><p>參數currentDist為當前距離，pKF為關鍵幀。此函數用來預測特徵點在金字塔哪一層可以找到</p>
<p>以下為示意圖 :
<img src="/ORBSLAM2-img/scale.JPG" alt="預測尺度"></p>
</div>
            </div>
            
                <script src="https://utteranc.es/client.js"
                    repo="Offliners/MyBlogComments"
                    issue-term="pathname"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>
                </script>
            
        </div>

        <div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
            
            <div class="layui-card single-card">
                <h2 class="single-title">- Table of Contents -</h2>
                <div style="margin-left: 10px;">   
                    <div>

<ul class="toc-h2"><li><a href="/post/orbslam2-code-3/#system-overview">System Overview</a></li>
            <li><a href="/post/orbslam2-code-3/#%e5%bb%ba%e6%a7%8b%e5%87%bd%e6%95%b8-mappoint">建構函數 MapPoint</a></li>
            <li><a href="/post/orbslam2-code-3/#%e5%a2%9e%e5%8a%a0%e5%9c%b0%e5%9c%96%e9%bb%9e%e7%9a%84%e8%a7%80%e6%b8%ac%e9%97%9c%e4%bf%82">增加地圖點的觀測關係</a></li>
            <li><a href="/post/orbslam2-code-3/#%e5%88%aa%e9%99%a4%e8%a7%80%e6%b8%ac%e9%97%9c%e4%bf%82">刪除觀測關係</a></li>
            <li><a href="/post/orbslam2-code-3/#%e5%88%aa%e9%99%a4%e5%9c%b0%e5%9c%96%e9%bb%9e">刪除地圖點</a></li>
            <li><a href="/post/orbslam2-code-3/#%e6%9b%bf%e6%8f%9b%e5%9c%b0%e5%9c%96%e9%bb%9e">替換地圖點</a></li>
            <li><a href="/post/orbslam2-code-3/#%e8%a8%88%e7%ae%97%e6%9c%80%e5%8c%b9%e9%85%8d%e7%9a%84%e6%8f%8f%e8%bf%b0%e5%ad%90">計算最匹配的描述子</a></li>
            <li><a href="/post/orbslam2-code-3/#%e6%9b%b4%e6%96%b0%e6%b3%95%e5%90%91%e9%87%8f%e8%88%87%e6%b7%b1%e5%ba%a6%e5%80%bc">更新法向量與深度值</a></li>
            <li><a href="/post/orbslam2-code-3/#%e9%a0%90%e6%b8%ac%e5%b0%ba%e5%ba%a6">預測尺度</a></li>
            </div>
                </div>
            </div>
            

            
            <div class="layui-card single-card">
                <h2 class="single-title">- Relevant Topics -</h2>
                
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/orbslam2-code-2/">
                                <h3 class="">ORBSLAM2 程式碼解析 - 系統流程</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-04-27</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/orbslam2-%e7%a8%8b%e5%bc%8f%e7%a2%bc%e8%a7%a3%e6%9e%90/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2 程式碼解析</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/orbslam2/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2</span>
        </a>
    
        <a href="/tags/code-analysis/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">code analysis</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/orbslam2-code-1/">
                                <h3 class="">ORBSLAM2 程式碼解析 - 論文閱讀</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-04-17</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/orbslam2-%e7%a8%8b%e5%bc%8f%e7%a2%bc%e8%a7%a3%e6%9e%90/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2 程式碼解析</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/orbslam2/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2</span>
        </a>
    
        <a href="/tags/code-analysis/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">code analysis</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/orbslam2-build/">
                                <h3 class="">ORBSLAM2 Build on Windows 10</h3>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-04-01</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/%e7%92%b0%e5%a2%83%e5%bb%ba%e7%ab%8b/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">環境建立</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/orbslam2/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2</span>
        </a>
    
        <a href="/tags/cmake/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">CMake</span>
        </a>
    
        <a href="/tags/visual-studio-2015/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Visual Studio 2015</span>
        </a>
    
        <a href="/tags/opencv/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">OpenCV</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                
                <br />
            </div>
            

            <div class="layui-card single-card">
                <h2 class="single-title">- Recent Posts -</h2>
            
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week13/">
                        <h3 class="">NTU - 機器學習 Week 13 - Explainable AI</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-16</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week11/">
                        <h3 class="">NTU - 機器學習 Week 11 - Adversarial Attack</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-15</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/orbslam2-code-5/">
                        <h3 class="">ORBSLAM2 程式碼解析 - KeyFrame</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-01</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/orbslam2-%e7%a8%8b%e5%bc%8f%e7%a2%bc%e8%a7%a3%e6%9e%90/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2 程式碼解析</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/orbslam2/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2</span>
        </a>
    
        <a href="/tags/code-analysis/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">code analysis</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntuml-week10/">
                        <h3 class="">NTU - 機器學習 Week 10 - Auto-Encoder</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-05-01</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/ntu-%e6%a9%9f%e5%99%a8%e5%ad%b8%e7%bf%92-note/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU 機器學習 note</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/machine-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Machine Learning</span>
        </a>
    
        <a href="/tags/deep-learning/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">Deep Learning</span>
        </a>
    
        <a href="/tags/ntu-ml-2021/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">NTU ML 2021</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/orbslam2-code-4/">
                        <h3 class="">ORBSLAM2 程式碼解析 - Frame</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2021-04-28</span>

    
     
    <i class="layui-icon layui-icon-list" style="font-size: 32px; vertical-align: -3px;"></i>
    

    
        <a href="/categories/orbslam2-%e7%a8%8b%e5%bc%8f%e7%a2%bc%e8%a7%a3%e6%9e%90/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2 程式碼解析</span>
        </a>
    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/orbslam2/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">ORBSLAM2</span>
        </a>
    
        <a href="/tags/code-analysis/">
            <span class="layui-badge layui-bg-orange" style="vertical-align: 2px;">code analysis</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
            
            <br />
            </div>
        </div>
    </div>
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WFQ2VM3C00"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WFQ2VM3C00');
</script>
    
</div>

        </div><footer>
    

    <div class="layui-container">
        <div class="layui-row">
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs6">
            </div>
        </div>
        <div class="layui-row">
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href="/zone/"><p class="footer-url">Archives</p></a>
            </div>
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href="/about/"><p class="footer-url">About</p></a>
            </div>
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href="/"><p class="footer-url">Home</p></a>
            </div>
            
        </div>
    </div>
    
    
    <div class="layui-container">
        <p class="copyright">&copy; All rights reserved. Powered by <a href='https://gohugo.io' style='color:#FFFFFF'>Hugo</a> and <a href='https://github.com/ertuil/erblog' style='color:#FFFFFF'>Erblog</a>.</p>
    </div>
</footer>

</body>
</html>
